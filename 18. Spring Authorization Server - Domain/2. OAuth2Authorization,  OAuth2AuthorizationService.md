-----
### OAuth2Authorization
-----
1. ë¦¬ì†ŒìŠ¤ ì†Œìœ ìì˜ ì—­í• ì´ ìˆëŠ” ê¶Œí•œ ë¶€ì—¬ ë°©ì‹(Access Token, Refresh Token, Client Credentials)ì˜ ê²½ìš°, ğŸ’¡ í´ë¼ì´ì–¸íŠ¸ì— ë¶€ì—¬ëœ ê¶Œí•œ ë¶€ì—¬, ì¦‰, ì¸ê°€ ìƒíƒœë¥¼ ìœ ì§€í•˜ëŠ” í´ë˜ìŠ¤ 
2. Spring Securityì˜ OAuth2 Clinetì˜ í•´ë‹¹ ì¸ì¦ ëª¨ë¸ì€ OAuth2AuthorizedClientì™€ ì„œë¡œ ëŒ€ì‘í•˜ëŠ” ê°œë… (ê¶Œí•œì„ ë°›ì•˜ë‹¤ëŠ” ì˜ë¯¸)
3. ê¶Œí•œ ë¶€ì—¬ íë¦„ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ë©´, OAuth2Authorizationì´ ìƒì„±ë˜ê³ , Access Tokenì´ ì €ì¥ë¨, ì„ íƒì ìœ¼ë¡œ Refresh Token, IDToken ë“± ì €ì¥
4. ìƒì„±ëœ OAuth2Authorizationì€ OAuth2AuthorizationServiceì— ì˜í•´ ë©”ëª¨ë¦¬ë‚˜ DBì— ì €ì¥
5. OAuth2Authorizationì— ì €ì¥ë˜ëŠ” OAuth2Token íƒ€ì…ë“¤ì€ ê¶Œí•œ ë¶€ì—¬ ìœ í˜• ë° Scopeì— ë”°ë¼ ë‹¤ë¦„

-----
### OAuth2AuthorizationService
-----
1. ìƒˆë¡œìš´ OAuth2Authorizationì„ ì €ì¥í•˜ê³ , ê¸°ì¡´ OAuth2Authorizationì„ ê²€ìƒ‰í•˜ëŠ” êµ¬ì„± ìš”ì†Œ
2. íŠ¹ì • ì—”ë“œí¬ì¸íŠ¸ í”„ë¡œí† ì½œ íë¦„ì„ ë”°ë¥¼ ë•Œ, ë‹¤ë¥¸ êµ¬ì„± ìš”ì†Œì—ì„œ ì‚¬ìš© (ì˜ˆ) í´ë¼ì´ì–¸íŠ¸ ì¸ì¦, ê¶Œí•œ ë¶€ì—¬ ì²˜ë¦¬, í† í° ìì²´ ê²€ì‚¬, í† í° ì·¨ì†Œ, ë™ì  í´ë¼ì´ì–¸íŠ¸ ë“±ë¡ ë“±)
3. ì œê³µë˜ëŠ” ê¸°ë³¸ êµ¬í˜„ì²´ : InMemoryOAuth2AuthorizationService ë° JdbcOAuth2AuthorizationService
4. InMemoryOAuth2AuthorizationService : ê°œë°œ ë° í…ŒìŠ¤íŠ¸ì—ì„œë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìœ¼ë©°, ê¸°ë³¸ ê°’
5. JdbcOAuth2AuthorizationService : JdbcTemplateì„ ì‚¬ìš©í•˜ë©° OAuth2Authorization ê°ì²´ë¥¼ DBì— ì €ì¥í•˜ì—¬ ìƒíƒœ ê³„ì† ìœ ì§€

<div align="center">
<img src="https://github.com/user-attachments/assets/62fbf1f2-03da-4e61-942c-78c8e98e4d20">
</div>

-----
### OAuth2Authorization êµ¬ì¡°
-----
<div align="center">
<img src="https://github.com/user-attachments/assets/ac155a0e-6bd1-4828-8122-bd856ae358a4">
</div>

  - AuthorizationCode : ì„ì‹œ ì½”ë“œ

-----
### ì½”ë“œ
-----
1. ì„ì‹œ ì½”ë“œ ë°œê¸‰
   - OAuth2AuthorizationCodeRequestAuthenticationProvider
```java
private Authentication authenticateAuthorizationRequest(Authentication authentication) throws AuthenticationException {
        OAuth2AuthorizationCodeRequestAuthenticationToken authorizationCodeRequestAuthentication = (OAuth2AuthorizationCodeRequestAuthenticationToken)authentication;
        RegisteredClient registeredClient = this.registeredClientRepository.findByClientId(authorizationCodeRequestAuthentication.getClientId());
        if (registeredClient == null) {
            throwError("invalid_request", "client_id", authorizationCodeRequestAuthentication, (RegisteredClient)null);
        }

        Map<Object, Object> context = new HashMap();
        context.put(RegisteredClient.class, registeredClient);
        OAuth2AuthenticationContext authenticationContext = new OAuth2AuthenticationContext(authorizationCodeRequestAuthentication, context);
        OAuth2AuthenticationValidator redirectUriValidator = this.resolveAuthenticationValidator("redirect_uri");
        redirectUriValidator.validate(authenticationContext);
        if (!registeredClient.getAuthorizationGrantTypes().contains(AuthorizationGrantType.AUTHORIZATION_CODE)) {
            throwError("unauthorized_client", "client_id", authorizationCodeRequestAuthentication, registeredClient);
        }

        OAuth2AuthenticationValidator scopeValidator = this.resolveAuthenticationValidator("scope");
        scopeValidator.validate(authenticationContext);
        String codeChallenge = (String)authorizationCodeRequestAuthentication.getAdditionalParameters().get("code_challenge");
        if (StringUtils.hasText(codeChallenge)) {
            String codeChallengeMethod = (String)authorizationCodeRequestAuthentication.getAdditionalParameters().get("code_challenge_method");
            if (!StringUtils.hasText(codeChallengeMethod) || !"S256".equals(codeChallengeMethod)) {
                throwError("invalid_request", "code_challenge_method", "https://datatracker.ietf.org/doc/html/rfc7636#section-4.4.1", authorizationCodeRequestAuthentication, registeredClient, (OAuth2AuthorizationRequest)null);
            }
        } else if (registeredClient.getClientSettings().isRequireProofKey()) {
            throwError("invalid_request", "code_challenge", "https://datatracker.ietf.org/doc/html/rfc7636#section-4.4.1", authorizationCodeRequestAuthentication, registeredClient, (OAuth2AuthorizationRequest)null);
        }

        Authentication principal = (Authentication)authorizationCodeRequestAuthentication.getPrincipal();
        if (!isPrincipalAuthenticated(principal)) {
            return authorizationCodeRequestAuthentication;
        } else {
            OAuth2AuthorizationRequest authorizationRequest = OAuth2AuthorizationRequest.authorizationCode().authorizationUri(authorizationCodeRequestAuthentication.getAuthorizationUri()).clientId(registeredClient.getClientId()).redirectUri(authorizationCodeRequestAuthentication.getRedirectUri()).scopes(authorizationCodeRequestAuthentication.getScopes()).state(authorizationCodeRequestAuthentication.getState()).additionalParameters(authorizationCodeRequestAuthentication.getAdditionalParameters()).build();
            OAuth2AuthorizationConsent currentAuthorizationConsent = this.authorizationConsentService.findById(registeredClient.getId(), principal.getName());
            if (requireAuthorizationConsent(registeredClient, authorizationRequest, currentAuthorizationConsent)) { 
                String state = DEFAULT_STATE_GENERATOR.generateKey();
                OAuth2Authorization authorization = authorizationBuilder(registeredClient, principal, authorizationRequest).attribute("state", state).build();
                this.authorizationService.save(authorization);
                Set<String> currentAuthorizedScopes = currentAuthorizationConsent != null ? currentAuthorizationConsent.getScopes() : null;
                return OAuth2AuthorizationCodeRequestAuthenticationToken.with(registeredClient.getClientId(), principal).authorizationUri(authorizationRequest.getAuthorizationUri()).scopes(currentAuthorizedScopes).state(state).consentRequired(true).build();
            } else {
                OAuth2TokenContext tokenContext = createAuthorizationCodeTokenContext(authorizationCodeRequestAuthentication, registeredClient, (OAuth2Authorization)null, authorizationRequest.getScopes());
                OAuth2AuthorizationCode authorizationCode = (OAuth2AuthorizationCode)this.authorizationCodeGenerator.generate(tokenContext); // ì„ì‹œ ì½”ë“œë¥¼ ìƒì„±í•´ ì €ì¥
                if (authorizationCode == null) {
                    OAuth2Error error = new OAuth2Error("server_error", "The token generator failed to generate the authorization code.", "https://datatracker.ietf.org/doc/html/rfc6749#section-4.1.2.1");
                    throw new OAuth2AuthorizationCodeRequestAuthenticationException(error, (OAuth2AuthorizationCodeRequestAuthenticationToken)null);
                } else {
                    OAuth2Authorization authorization = authorizationBuilder(registeredClient, principal, authorizationRequest).token(authorizationCode).attribute(OAuth2Authorization.AUTHORIZED_SCOPE_ATTRIBUTE_NAME, authorizationRequest.getScopes()).build(); // OAuth2Authorizationì— ì„ì‹œ ì½”ë“œ ì €ì¥ (í´ë¼ì´ì–¸íŠ¸ê°€ ê°€ì ¸ì˜¤ëŠ” Codeì™€ ìì‹ ì´ ì €ì¥í•œ Codeë¥¼ ë¹„êµí•˜ê¸° ìœ„í•¨ì´ë©°, ì´ë¥¼ ê°€ì§€ê³  ìˆëŠ” authorization ê°ì²´ë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•¨) [Sessionê³¼ ìœ ì‚¬]
                    this.authorizationService.save(authorization); // í† í°ì— ì €ì¥
                    String redirectUri = authorizationRequest.getRedirectUri();
                    if (!StringUtils.hasText(redirectUri)) {
                        redirectUri = (String)registeredClient.getRedirectUris().iterator().next();
                    }

                    return OAuth2AuthorizationCodeRequestAuthenticationToken.with(registeredClient.getClientId(), principal).authorizationUri(authorizationRequest.getAuthorizationUri()).redirectUri(redirectUri).scopes(authorizationRequest.getScopes()).state(authorizationRequest.getState()).authorizationCode(authorizationCode).build();
                }
            }
        }
}
```

  - OAuth2Authorization
```java
public class OAuth2Authorization implements Serializable {

...

    public static class Token<T extends OAuth2Token> implements Serializable {

        
        private final T token; // ì„ì‹œ ì½”ë“œ ì €ì¥

        ...

    }

...

}
```

2. í† í° ìš”ì²­
   - CodeVerifierAuthenticator
```java
 private boolean authenticate(OAuth2ClientAuthenticationToken clientAuthentication, RegisteredClient registeredClient) {
        Map<String, Object> parameters = clientAuthentication.getAdditionalParameters();
        if (!authorizationCodeGrant(parameters)) {
            return false;
        } else {
            OAuth2Authorization authorization = this.authorizationService.findByToken((String)parameters.get("code"), AUTHORIZATION_CODE_TOKEN_TYPE); // findByToken : ì €ì¥ëœ token(ì„ì‹œ ì½”ë“œ) ê°€ì ¸ì˜´ [InMemoryOAuth2AuthorizationService]
            if (authorization == null) {
                throwInvalidGrant("code");
            }

            OAuth2AuthorizationRequest authorizationRequest = (OAuth2AuthorizationRequest)authorization.getAttribute(OAuth2AuthorizationRequest.class.getName());
            String codeChallenge = (String)authorizationRequest.getAdditionalParameters().get("code_challenge");
            if (!StringUtils.hasText(codeChallenge)) {
                if (!registeredClient.getClientSettings().isRequireProofKey()) {
                    return false;
                }

                throwInvalidGrant("code_challenge");
            }

            String codeChallengeMethod = (String)authorizationRequest.getAdditionalParameters().get("code_challenge_method");
            String codeVerifier = (String)parameters.get("code_verifier");
            if (!codeVerifierValid(codeVerifier, codeChallenge, codeChallengeMethod)) {
                throwInvalidGrant("code_verifier");
            }

            return true;
        }
}
```

  - InMemoryOAuth2AuthorizationService
```java
@Nullable
public OAuth2Authorization findByToken(String token, @Nullable OAuth2TokenType tokenType) {
        Assert.hasText(token, "token cannot be empty");
        Iterator var3 = this.authorizations.values().iterator();

        OAuth2Authorization authorization;
        do {
            if (!var3.hasNext()) {
                var3 = this.initializedAuthorizations.values().iterator();

                do {
                    if (!var3.hasNext()) {
                        return null;
                    }

                    authorization = (OAuth2Authorization)var3.next();
                } while(!hasToken(authorization, token, tokenType));

                return authorization;
            }

            authorization = (OAuth2Authorization)var3.next();
        } while(!hasToken(authorization, token, tokenType));

        return authorization;
}

private static boolean hasToken(OAuth2Authorization authorization, String token, @Nullable OAuth2TokenType tokenType) {
        if (tokenType != null) {
            if ("state".equals(tokenType.getValue())) {
                return matchesState(authorization, token);
            } else if ("code".equals(tokenType.getValue())) {
                return matchesAuthorizationCode(authorization, token);
            } else if (OAuth2TokenType.ACCESS_TOKEN.equals(tokenType)) {
                return matchesAccessToken(authorization, token);
            } else {
                return OAuth2TokenType.REFRESH_TOKEN.equals(tokenType) ? matchesRefreshToken(authorization, token) : false;
            }
        } else {
            return matchesState(authorization, token) || matchesAuthorizationCode(authorization, token) || matchesAccessToken(authorization, token) || matchesRefreshToken(authorization, token);
        }
}

private static boolean matchesAuthorizationCode(OAuth2Authorization authorization, String token) {
        OAuth2Authorization.Token<OAuth2AuthorizationCode> authorizationCode = authorization.getToken(OAuth2AuthorizationCode.class);
        return authorizationCode != null && ((OAuth2AuthorizationCode)authorizationCode.getToken()).getTokenValue().equals(token); // í´ë¼ì´ì–¸íŠ¸ì˜ í† í°ê³¼ ì‹¤ì œ ì¸ê°€ ì„œë²„ê°€ ë³´ìœ í•˜ê³  ìˆëŠ” ì½”ë“œê°€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
}
```

  - OAuth2AuthorizationCodeAuthenticationProvider
```java
public Authentication authenticate(Authentication authentication) throws AuthenticationException {
        OAuth2AuthorizationCodeAuthenticationToken authorizationCodeAuthentication = (OAuth2AuthorizationCodeAuthenticationToken)authentication;
        OAuth2ClientAuthenticationToken clientPrincipal = OAuth2AuthenticationProviderUtils.getAuthenticatedClientElseThrowInvalidClient(authorizationCodeAuthentication);
        RegisteredClient registeredClient = clientPrincipal.getRegisteredClient();
        OAuth2Authorization authorization = this.authorizationService.findByToken(authorizationCodeAuthentication.getCode(), AUTHORIZATION_CODE_TOKEN_TYPE);
        if (authorization == null) {
            throw new OAuth2AuthenticationException("invalid_grant");
        } else {
            OAuth2Authorization.Token<OAuth2AuthorizationCode> authorizationCode = authorization.getToken(OAuth2AuthorizationCode.class);
            OAuth2AuthorizationRequest authorizationRequest = (OAuth2AuthorizationRequest)authorization.getAttribute(OAuth2AuthorizationRequest.class.getName());
            if (!registeredClient.getClientId().equals(authorizationRequest.getClientId())) {
                if (!authorizationCode.isInvalidated()) {
                    authorization = OAuth2AuthenticationProviderUtils.invalidate(authorization, authorizationCode.getToken());
                    this.authorizationService.save(authorization);
                }

                throw new OAuth2AuthenticationException("invalid_grant");
            } else if (StringUtils.hasText(authorizationRequest.getRedirectUri()) && !authorizationRequest.getRedirectUri().equals(authorizationCodeAuthentication.getRedirectUri())) {
                throw new OAuth2AuthenticationException("invalid_grant");
            } else if (!authorizationCode.isActive()) {
                throw new OAuth2AuthenticationException("invalid_grant");
            } else {
                DefaultOAuth2TokenContext.Builder tokenContextBuilder = (DefaultOAuth2TokenContext.Builder)((DefaultOAuth2TokenContext.Builder)((DefaultOAuth2TokenContext.Builder)((DefaultOAuth2TokenContext.Builder)((DefaultOAuth2TokenContext.Builder)((DefaultOAuth2TokenContext.Builder)((DefaultOAuth2TokenContext.Builder)DefaultOAuth2TokenContext.builder().registeredClient(registeredClient)).principal((Authentication)authorization.getAttribute(Principal.class.getName()))).providerContext(ProviderContextHolder.getProviderContext())).authorization(authorization)).authorizedScopes((Set)authorization.getAttribute(OAuth2Authorization.AUTHORIZED_SCOPE_ATTRIBUTE_NAME))).authorizationGrantType(AuthorizationGrantType.AUTHORIZATION_CODE)).authorizationGrant(authorizationCodeAuthentication);
                OAuth2Authorization.Builder authorizationBuilder = OAuth2Authorization.from(authorization);
                OAuth2TokenContext tokenContext = ((DefaultOAuth2TokenContext.Builder)tokenContextBuilder.tokenType(OAuth2TokenType.ACCESS_TOKEN)).build();
                OAuth2Token generatedAccessToken = this.tokenGenerator.generate(tokenContext);
                if (generatedAccessToken == null) {
                    OAuth2Error error = new OAuth2Error("server_error", "The token generator failed to generate the access token.", "https://datatracker.ietf.org/doc/html/rfc6749#section-5.2");
                    throw new OAuth2AuthenticationException(error);
                } else {
                    OAuth2AccessToken accessToken = new OAuth2AccessToken(TokenType.BEARER, generatedAccessToken.getTokenValue(), generatedAccessToken.getIssuedAt(), generatedAccessToken.getExpiresAt(), tokenContext.getAuthorizedScopes());
                    if (generatedAccessToken instanceof ClaimAccessor) { // í† í°ì„ ê°€ì ¸ì˜´ (ì„ì‹œ ì½”ë“œëŠ” ë°œê¸‰ë°›ì•˜ìœ¼ë¯€ë¡œ ì¡´ì¬, ì´ ì„ì‹œì½”ë“œë¥¼ í†µí•´)
                        authorizationBuilder.token(accessToken, (metadata) -> {
                            metadata.put(Token.CLAIMS_METADATA_NAME, ((ClaimAccessor)generatedAccessToken).getClaims());
                        });
                    } else {
                        authorizationBuilder.accessToken(accessToken); // Access Token ìƒì„± í›„ ì €ì¥
                    }

                    OAuth2RefreshToken refreshToken = null;
                    if (registeredClient.getAuthorizationGrantTypes().contains(AuthorizationGrantType.REFRESH_TOKEN) && !clientPrincipal.getClientAuthenticationMethod().equals(ClientAuthenticationMethod.NONE)) {
                        tokenContext = ((DefaultOAuth2TokenContext.Builder)tokenContextBuilder.tokenType(OAuth2TokenType.REFRESH_TOKEN)).build();
                        OAuth2Token generatedRefreshToken = this.tokenGenerator.generate(tokenContext);
                        if (!(generatedRefreshToken instanceof OAuth2RefreshToken)) {
                            OAuth2Error error = new OAuth2Error("server_error", "The token generator failed to generate the refresh token.", "https://datatracker.ietf.org/doc/html/rfc6749#section-5.2");
                            throw new OAuth2AuthenticationException(error);
                        }

                        refreshToken = (OAuth2RefreshToken)generatedRefreshToken;
                        authorizationBuilder.refreshToken(refreshToken); // Refresh Token ìƒì„± í›„ ì €ì¥
                    }

                    OidcIdToken idToken;
                    if (authorizationRequest.getScopes().contains("openid")) {
                        tokenContext = ((DefaultOAuth2TokenContext.Builder)((DefaultOAuth2TokenContext.Builder)tokenContextBuilder.tokenType(ID_TOKEN_TOKEN_TYPE)).authorization(authorizationBuilder.build())).build();
                        OAuth2Token generatedIdToken = this.tokenGenerator.generate(tokenContext);
                        if (!(generatedIdToken instanceof Jwt)) {
                            OAuth2Error error = new OAuth2Error("server_error", "The token generator failed to generate the ID token.", "https://datatracker.ietf.org/doc/html/rfc6749#section-5.2");
                            throw new OAuth2AuthenticationException(error);
                        }

                        idToken = new OidcIdToken(generatedIdToken.getTokenValue(), generatedIdToken.getIssuedAt(), generatedIdToken.getExpiresAt(), ((Jwt)generatedIdToken).getClaims()); // Id token ìƒì„± í›„ ì €ì¥
                        authorizationBuilder.token(idToken, (metadata) -> {
                            metadata.put(Token.CLAIMS_METADATA_NAME, idToken.getClaims());
                        });
                    } else {
                        idToken = null;
                    }

                    authorization = authorizationBuilder.build();  // ì´ 4ê°œì˜ í† í°(ì„ì‹œ ì½”ë“œ, Access Token, Refresh Token, ID token)ì— ëŒ€í•´ ìƒíƒœ ìœ ì§€
                    authorization = OAuth2AuthenticationProviderUtils.invalidate(authorization, authorizationCode.getToken()); // ì„ì‹œ ì½”ë“œëŠ” ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ëª»í•˜ë„ë¡ ì°¨ë‹¨(metadata : metadata.token.invaild : true), ë‚˜ë¨¸ì§€ëŠ” ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ í•¨
                    this.authorizationService.save(authorization); // InMemoryOAuth2AuthorizationService
                    Map<String, Object> additionalParameters = Collections.emptyMap();
                    if (idToken != null) {
                        additionalParameters = new HashMap();
                        ((Map)additionalParameters).put("id_token", idToken.getTokenValue());
                    }

                    return new OAuth2AccessTokenAuthenticationToken(registeredClient, clientPrincipal, accessToken, refreshToken, (Map)additionalParameters);
                }
            }
        }
}
```

  - InMemoryOAuth2AuthorizationService
```java
public void save(OAuth2Authorization authorization) {
        Assert.notNull(authorization, "authorization cannot be null");
        if (isComplete(authorization)) { // ì´ì „ì— í–ˆë˜ í† í° ê°’ ìœ ì§€ / ì¶”ê°€ì ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì— ëŒ€í•´ ë˜ ì €ì¥ (ìš”ì²­ë§ˆë‹¤ ìƒì„±í•˜ì—¬ ìœ ì§€) >> ë”°ë¼ì„œ, ë©”ëª¨ë¦¬ ë°©ì‹ì—ì„œëŠ” ë¹„íš¨ìœ¨ì ì´ë¯€ë¡œ DB ì‚¬ìš© >> ìƒíƒœ ìœ ì§€
            this.authorizations.put(authorization.getId(), authorization);
        } else {
            this.initializedAuthorizations.put(authorization.getId(), authorization);
        }
}

private static boolean isComplete(OAuth2Authorization authorization) {
        return authorization.getAccessToken() != null;
}
```

3. DefaultSecurityConfig
```java
package io.security.oauth2.springsecurityoauth2;

import org.springframework.context.annotation.Bean;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.oauth2.server.authorization.InMemoryOAuth2AuthorizationService;
import org.springframework.security.oauth2.server.authorization.OAuth2AuthorizationService;
import org.springframework.security.provisioning.InMemoryUserDetailsManager;
import org.springframework.security.web.SecurityFilterChain;

@EnableWebSecurity
public class DefaultSecurityConfig {

    @Bean
    public SecurityFilterChain defauktSecurityFilterChain(HttpSecurity http) throws Exception {
        http.authorizeRequests(authorizeRequests ->
                authorizeRequests.anyRequest().authenticated());

        // ì¸ì¦ì„ ë°›ì§€ ëª»í•˜ë©´ Form ë¡œê·¸ì¸
        http.formLogin();

        return http.build();
    }

    @Bean
    public UserDetailsService userDetailsService() {
        // í•˜ë‚˜ì˜ ì‚¬ìš©ì ê³„ì • ìƒì„± (ì´ ê³„ì •ë§Œìœ¼ë¡œë§Œ ì ‘ê·¼)

        UserDetails user = User.withUsername("user").password("{noop}1234").authorities("ROLE_USER").build();
        return new InMemoryUserDetailsManager(user);
    }
    
    @Bean
    public OAuth2AuthorizationService oAuth2AuthorizationService() {
        return new InMemoryOAuth2AuthorizationService(); // í´ë˜ìŠ¤ë¡œ ë“±ë¡ë˜ì–´ ìˆìœ¼ë¯€ë¡œ, ë¹ˆìœ¼ë¡œ ë“±ë¡
    }
}
```

4. OAuth2AuthorizationController
```java
package io.security.oauth2.springsecurityoauth2;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.oauth2.core.OAuth2TokenType;
import org.springframework.security.oauth2.server.authorization.OAuth2Authorization;
import org.springframework.security.oauth2.server.authorization.OAuth2AuthorizationService;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class OAuth2AuthorizationController {

    @Autowired
    private OAuth2AuthorizationService oAuth2AuthorizationService;

    @GetMapping("/authorization")
    public OAuth2Authorization oAuth2Authorization(String token) {
        return oAuth2AuthorizationService.findByToken(token, OAuth2TokenType.ACCESS_TOKEN); // tokenì— ëŒ€í•´ Access Token íƒ€ì…ì— ì¼ì¹˜í•˜ëŠ” ê°ì²´ ë°˜í™˜
    }
}
```
