-----
### π’΅ OAuth 2.0 Roles
-----
1. OAuth 2.0 λ©”μ»¤λ‹μ¦μ€ λ„¤ κ°€μ§€ μΆ…λ¥μ μ—­ν• μ„ λ‹΄λ‹Ήν•λ” μ£Όμ²΄λ“¤μ— μν•΄ μ΄λ£¨μ–΄μ§€λ” κ¶ν• λ¶€μ—¬ μ²΄κ³„

2. Resource Owner (μμ› μ†μ μ) / μ‚¬μ©μ
   - λ³΄νΈλ μμ›μ— λ€ν• μ ‘κ·Ό κ¶ν•μ„ λ¶€μ—¬ν•  μ μλ” μ£Όμ²΄, μ‚¬μ©μλ΅μ„ κ³„μ •μ μΌλ¶€μ— λ€ν• μ ‘κ·Ό κ¶ν•μ„ λ¶€μ—¬ν•λ” μ‚¬λ
   - μ‚¬μ©μλ¥Ό λ€μ‹ ν•μ—¬ μ‘λ™ν•λ ¤λ” λ¨λ“  ν΄λΌμ΄μ–ΈνΈλ” λ¨Όμ € μ‚¬μ©μμ ν—κ°€λ¥Ό λ°›μ•„μ•Ό ν•¨

3. Resource Server (λ³΄νΈ μμ› μ„λ²„)
   - νƒ€ μ‚¬ μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ μ ‘κ·Όν•λ” μ‚¬μ©μμ μμ›μ΄ ν¬ν•¨λ μ„λ²„λ¥Ό μλ―Έ
   - μ•΅μ„Έμ¤ ν† ν°μ„ μλ½ λ° κ²€μ¦ν•  μ μμ–΄μ•Ό ν•λ©°, κ¶ν• μ²΄κ³„μ— λ”°λΌ μ”μ²­μ„ μΉμΈν•  μ μμ–΄μ•Ό ν•¨

4. Authorization Server (μΈκ°€ μ„λ²„)
   - ν΄λΌμ΄μ–ΈνΈκ°€ μ‚¬μ©μ κ³„μ •μ— λ€ν• λ™μ λ° μ ‘κ·Όμ„ μ”μ²­ν•  λ• μƒνΈ μ‘μ©ν•λ” μ„λ²„λ΅μ„ ν΄λΌμ΄μ–ΈνΈμ κ¶ν• λ¶€μ—¬ μ”μ²­μ„ μΉμΈν•κ±°λ‚ κ±°λ¶€ν•λ” μ„λ²„
   - μ‚¬μ©μκ°€ ν΄λΌμ΄μ–ΈνΈμ—κ² κ¶ν• λ¶€μ—¬ μ”μ²­μ„ μΉμΈ ν›„ Access Tokenμ„ ν΄λΌμ΄μ–ΈνΈμ—κ² λ¶€μ—¬ν•λ” μ—­ν• 

5. Client (ν΄λΌμ΄μ–ΈνΈ)
   - μ‚¬μ©μλ¥Ό λ€μ‹ ν•μ—¬ κ¶ν•μ„ λ¶€μ—¬λ°›μ•„ μ‚¬μ©μμ λ¦¬μ†μ¤μ— μ ‘κ·Όν•λ ¤λ” μ• ν”λ¦¬μΌ€μ΄μ…
   - μ‚¬μ©μλ¥Ό κ¶ν• λ¶€μ—¬ μ„λ²„λ΅ μ•λ‚΄ν•κ±°λ‚ μ‚¬μ©μμ μƒνΈ μ‘μ© μ—†μ΄ κ¶ν• λ¶€μ—¬ μ„λ²„λ΅λ¶€ν„° μ§μ ‘ κ¶ν•μ„ μ–»μ„ μ μμ

<div align="center">
<img src="https://github.com/user-attachments/assets/baf127ce-3534-4b96-a3d6-7593b201dd5e">
</div>

  - Access Tokenμ— λ€ν•΄μ„ Resource Serverκ°€ μμ²΄μ  κ²€μ¦ λλ” Authorization Serverμ— κ²€μ¦ν•λ” λ°©λ²• 2κ°€μ§€ μ΅΄μ¬

-----
### ν…μ¤νΈ
-----
1. Postman Colletions μƒμ„± (OAuth 2.0 μ©μ–΄ μ΄ν•΄)
2. μΈκ°€ μ„λ²„λ΅λ¶€ν„° ν΄λΌμ΄μ–ΈνΈκ°€ μµμΆ… κ¶ν• λ¶€μ—¬λ¥Ό λ°›κΈ° μ„ν• κ³Όμ •
   - GET http://localhost:8080/realms/oauth2/protocol/openid-connect/auth?response_type=code&client_id=oauth2-client-app&scope=profile email&redirect_uri=http://localhost:8081
   - response_type : code (μ΄λ¥Ό ν†µν•΄ Access Token λ°κΈ‰)
   - client_id : Keycloakμ— λ“±λ΅ν• Client
   - scope : ν΄λΌμ΄μ–ΈνΈκ°€ μ‚¬μ©μμ μ‚¬μ© κ°€λ¥ν• μ ν•λ λ²”μ„
   - redirect_uri : μ‹¤μ  ν΄λΌμ΄μ–ΈνΈμ URI μ •λ³΄ (Codeλ¥Ό μ”μ²­ν• λ’¤, μΈκ°€ μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈμ—κ² μ½”λ“λ¥Ό λ°κΈ‰ν•΄μ•Ό λλ” URI μ •λ³΄)

   - λ΅κ·ΈμΈ μ”μ²­ μ‘λ‹µ
```html
<!DOCTYPE html>
<html class="login-pf" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="robots" content="noindex, nofollow">
    <meta name="color-scheme" content="light dark">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Sign in to Oauth2</title>
    <link rel="icon" href="/resources/q9vij/login/keycloak.v2/img/favicon.ico" />
            <link href="/resources/q9vij/common/keycloak/vendor/patternfly-v5/patternfly.min.css" rel="stylesheet" />
            <link href="/resources/q9vij/common/keycloak/vendor/patternfly-v5/patternfly-addons.css" rel="stylesheet" />
            <link href="/resources/q9vij/login/keycloak.v2/css/styles.css" rel="stylesheet" />
    <script type="importmap">
        {
            "imports": {
                "rfc4648": "/resources/q9vij/common/keycloak/vendor/rfc4648/rfc4648.js"
            }
        }
    </script>
      <script type="module" async blocking="render">
          const DARK_MODE_CLASS = "pf-v5-theme-dark";
          const mediaQuery = window.matchMedia("(prefers-color-scheme: dark)");

          updateDarkMode(mediaQuery.matches);
          mediaQuery.addEventListener("change", (event) => updateDarkMode(event.matches));

          function updateDarkMode(isEnabled) {
            const { classList } = document.documentElement;

            if (isEnabled) {
              classList.add(DARK_MODE_CLASS);
            } else {
              classList.remove(DARK_MODE_CLASS);
            }
          }
      </script>
    <script type="module" src="/resources/q9vij/login/keycloak.v2/js/passwordVisibility.js"></script>
    <script type="module">
        import { startSessionPolling } from "/resources/q9vij/login/keycloak.v2/js/authChecker.js";

        startSessionPolling(
            "/realms/Oauth2/login-actions/restart?client_id=oauth2-client-app&tab_id=8f8WPLZBQYE&client_data=eyJydSI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MSIsInJ0IjoiY29kZSJ9&skip_logout=true"
        );
    </script>
        <script type="module">
            import { checkAuthSession } from "/resources/q9vij/login/keycloak.v2/js/authChecker.js";

            checkAuthSession(
                "jEXCMa33aBP0WIX8oU5QcwsUnUK9uNUFpO+KNuyYxpA"
            );
        </script>
    <script>
      // Workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=1404468
      const isFirefox = true;
    </script>
</head>

<body id="keycloak-bg" class="">
<div class="pf-v5-c-login">
  <div class="pf-v5-c-login__container">
    <header id="kc-header" class="pf-v5-c-login__header">
      <div id="kc-header-wrapper"
              class="pf-v5-c-brand">Oauth2</div>
    </header>
    <main class="pf-v5-c-login__main">
      <div class="pf-v5-c-login__main-header">
        <h1 class="pf-v5-c-title pf-m-3xl" id="kc-page-title"><!-- template: login.ftl -->

        Sign in to your account

</h1>
      </div>
      <div class="pf-v5-c-login__main-body">


<!-- template: login.ftl -->

        <div id="kc-form">
          <div id="kc-form-wrapper">
                <form id="kc-form-login" class="pf-v5-c-form" onsubmit="login.disabled = true; return true;" action="http://localhost:8080/realms/Oauth2/login-actions/authenticate?session_code=8JXNfAwRDGS2-yctFmVgwWh4vPsehZNKyYi-GucU1GE&amp;execution=048bd5f1-3361-4bc2-bf3f-d659c6d6851f&amp;client_id=oauth2-client-app&amp;tab_id=8f8WPLZBQYE&amp;client_data=eyJydSI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MSIsInJ0IjoiY29kZSJ9" method="post" novalidate="novalidate">

<div class="pf-v5-c-form__group">
    <div class="pf-v5-c-form__label">
        <label for="username" class="pf-v5-c-form__label">
        <span class="pf-v5-c-form__label-text">
                                        Username or email

        </span>
        </label>
    </div>

    <span class="pf-v5-c-form-control ">
        <input id="username" name="username" value="" type="text" autocomplete="username" autofocus
                aria-invalid=""/>
    </span>

    <div id="input-error-container-username">
    </div>
</div>


<div class="pf-v5-c-form__group">
    <div class="pf-v5-c-form__label">
        <label for="password" class="pf-v5-c-form__label">
        <span class="pf-v5-c-form__label-text">
            Password
        </span>
        </label>
    </div>

    <div class="pf-v5-c-input-group">
      <div class="pf-v5-c-input-group__item pf-m-fill">
        <span class="pf-v5-c-form-control ">
          <input id="password" name="password" value="" type="password" autocomplete="current-password" 
                  aria-invalid=""/>
        </span>
      </div>
      <div class="pf-v5-c-input-group__item">
        <button class="pf-v5-c-button pf-m-control" type="button" aria-label="Show password"
                aria-controls="password" data-password-toggle
                data-icon-show="fa-eye fas" data-icon-hide="fa-eye-slash fas"
                data-label-show="Show password" data-label-hide="Hide password">
            <i class="fa-eye fas" aria-hidden="true"></i>
        </button>
      </div>
    </div>

    <div id="input-error-container-password">
    </div>
</div>


                    <div class="pf-v5-c-form__group">
                    </div>

                    <input type="hidden" id="id-hidden-input" name="credentialId" />
  <div class="pf-v5-c-form__group">
    <div class="pf-v5-c-form__actions">
  <button class="pf-v5-c-button pf-m-primary pf-m-block " name="login" id="kc-login" type="submit">Sign In</button>
    </div>
  </div>
                </form>
            </div>
        </div>



      </div>
      <div class="pf-v5-c-login__main-footer">
<!-- template: login.ftl -->


      </div>
    </main>

  </div>
</div>
</body>
</html>
```

   - Client oauth2-client-appμ Settingsμ—μ„ Consent required On
   - http://localhost:8080/realms/Oauth2/protocol/openid-connect/auth?response_type=code&client_id=oauth2-client-app&scope=profile email&redirect_uri=http://localhost:8081 λ΅ λΈλΌμ°μ €λ΅ μ ‘μ†
     + μ‚¬μ©μ μ •λ³΄ (user) μ…λ ¥

3. 

