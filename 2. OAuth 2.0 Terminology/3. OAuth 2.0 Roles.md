![image](https://github.com/user-attachments/assets/f58b337b-09c5-4bb0-85bd-cf04f7485bc7)-----
### ğŸ’¡ OAuth 2.0 Roles
-----
1. OAuth 2.0 ë©”ì»¤ë‹ˆì¦˜ì€ ë„¤ ê°€ì§€ ì¢…ë¥˜ì˜ ì—­í• ì„ ë‹´ë‹¹í•˜ëŠ” ì£¼ì²´ë“¤ì— ì˜í•´ ì´ë£¨ì–´ì§€ëŠ” ê¶Œí•œ ë¶€ì—¬ ì²´ê³„

2. Resource Owner (ìì› ì†Œìœ ì) / ì‚¬ìš©ì
   - ë³´í˜¸ëœ ìì›ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆëŠ” ì£¼ì²´, ì‚¬ìš©ìë¡œì„œ ê³„ì •ì˜ ì¼ë¶€ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ì‚¬ëŒ
   - ì‚¬ìš©ìë¥¼ ëŒ€ì‹ í•˜ì—¬ ì‘ë™í•˜ë ¤ëŠ” ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ëŠ” ë¨¼ì € ì‚¬ìš©ìì˜ í—ˆê°€ë¥¼ ë°›ì•„ì•¼ í•¨

3. Resource Server (ë³´í˜¸ ìì› ì„œë²„)
   - íƒ€ ì‚¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì ‘ê·¼í•˜ëŠ” ì‚¬ìš©ìì˜ ìì›ì´ í¬í•¨ëœ ì„œë²„ë¥¼ ì˜ë¯¸
   - ì•¡ì„¸ìŠ¤ í† í°ì„ ìˆ˜ë½ ë° ê²€ì¦í•  ìˆ˜ ìˆì–´ì•¼ í•˜ë©°, ê¶Œí•œ ì²´ê³„ì— ë”°ë¼ ìš”ì²­ì„ ìŠ¹ì¸í•  ìˆ˜ ìˆì–´ì•¼ í•¨

4. Authorization Server (ì¸ê°€ ì„œë²„)
   - í´ë¼ì´ì–¸íŠ¸ê°€ ì‚¬ìš©ì ê³„ì •ì— ëŒ€í•œ ë™ì˜ ë° ì ‘ê·¼ì„ ìš”ì²­í•  ë•Œ ìƒí˜¸ ì‘ìš©í•˜ëŠ” ì„œë²„ë¡œì„œ í´ë¼ì´ì–¸íŠ¸ì˜ ê¶Œí•œ ë¶€ì—¬ ìš”ì²­ì„ ìŠ¹ì¸í•˜ê±°ë‚˜ ê±°ë¶€í•˜ëŠ” ì„œë²„
   - ì‚¬ìš©ìê°€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ê¶Œí•œ ë¶€ì—¬ ìš”ì²­ì„ ìŠ¹ì¸ í›„ Access Tokenì„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë¶€ì—¬í•˜ëŠ” ì—­í• 

5. Client (í´ë¼ì´ì–¸íŠ¸)
   - ì‚¬ìš©ìë¥¼ ëŒ€ì‹ í•˜ì—¬ ê¶Œí•œì„ ë¶€ì—¬ë°›ì•„ ì‚¬ìš©ìì˜ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•˜ë ¤ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜
   - ì‚¬ìš©ìë¥¼ ê¶Œí•œ ë¶€ì—¬ ì„œë²„ë¡œ ì•ˆë‚´í•˜ê±°ë‚˜ ì‚¬ìš©ìì˜ ìƒí˜¸ ì‘ìš© ì—†ì´ ê¶Œí•œ ë¶€ì—¬ ì„œë²„ë¡œë¶€í„° ì§ì ‘ ê¶Œí•œì„ ì–»ì„ ìˆ˜ ìˆìŒ

<div align="center">
<img src="https://github.com/user-attachments/assets/baf127ce-3534-4b96-a3d6-7593b201dd5e">
</div>

  - Access Tokenì— ëŒ€í•´ì„œ Resource Serverê°€ ìì²´ì  ê²€ì¦ ë˜ëŠ” Authorization Serverì— ê²€ì¦í•˜ëŠ” ë°©ë²• 2ê°€ì§€ ì¡´ì¬

-----
### í…ŒìŠ¤íŠ¸
-----
1. Postman Colletions ìƒì„± (OAuth 2.0 ìš©ì–´ ì´í•´)
2. ì¸ê°€ ì„œë²„ë¡œë¶€í„° í´ë¼ì´ì–¸íŠ¸ê°€ ìµœì¢… ê¶Œí•œ ë¶€ì—¬ë¥¼ ë°›ê¸° ìœ„í•œ ê³¼ì •
   - GET http://localhost:8080/realms/oauth2/protocol/openid-connect/auth?response_type=code&client_id=oauth2-client-app&scope=profile email&redirect_uri=http://localhost:8081
   - response_type : code (ì´ë¥¼ í†µí•´ Access Token ë°œê¸‰)
   - client_id : Keycloakì— ë“±ë¡í•œ Client
   - scope : í´ë¼ì´ì–¸íŠ¸ê°€ ì‚¬ìš©ìì˜ ì‚¬ìš© ê°€ëŠ¥í•œ ì œí•œëœ ë²”ìœ„
   - redirect_uri : ì‹¤ì œ í´ë¼ì´ì–¸íŠ¸ì˜ URI ì •ë³´ (Codeë¥¼ ìš”ì²­í•œ ë’¤, ì¸ê°€ ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì½”ë“œë¥¼ ë°œê¸‰í•´ì•¼ ë˜ëŠ” URI ì •ë³´)

   - ë¡œê·¸ì¸ ìš”ì²­ ì‘ë‹µ
```html
<!DOCTYPE html>
<html class="login-pf" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="robots" content="noindex, nofollow">
    <meta name="color-scheme" content="light dark">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Sign in to Oauth2</title>
    <link rel="icon" href="/resources/q9vij/login/keycloak.v2/img/favicon.ico" />
            <link href="/resources/q9vij/common/keycloak/vendor/patternfly-v5/patternfly.min.css" rel="stylesheet" />
            <link href="/resources/q9vij/common/keycloak/vendor/patternfly-v5/patternfly-addons.css" rel="stylesheet" />
            <link href="/resources/q9vij/login/keycloak.v2/css/styles.css" rel="stylesheet" />
    <script type="importmap">
        {
            "imports": {
                "rfc4648": "/resources/q9vij/common/keycloak/vendor/rfc4648/rfc4648.js"
            }
        }
    </script>
      <script type="module" async blocking="render">
          const DARK_MODE_CLASS = "pf-v5-theme-dark";
          const mediaQuery = window.matchMedia("(prefers-color-scheme: dark)");

          updateDarkMode(mediaQuery.matches);
          mediaQuery.addEventListener("change", (event) => updateDarkMode(event.matches));

          function updateDarkMode(isEnabled) {
            const { classList } = document.documentElement;

            if (isEnabled) {
              classList.add(DARK_MODE_CLASS);
            } else {
              classList.remove(DARK_MODE_CLASS);
            }
          }
      </script>
    <script type="module" src="/resources/q9vij/login/keycloak.v2/js/passwordVisibility.js"></script>
    <script type="module">
        import { startSessionPolling } from "/resources/q9vij/login/keycloak.v2/js/authChecker.js";

        startSessionPolling(
            "/realms/Oauth2/login-actions/restart?client_id=oauth2-client-app&tab_id=8f8WPLZBQYE&client_data=eyJydSI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MSIsInJ0IjoiY29kZSJ9&skip_logout=true"
        );
    </script>
        <script type="module">
            import { checkAuthSession } from "/resources/q9vij/login/keycloak.v2/js/authChecker.js";

            checkAuthSession(
                "jEXCMa33aBP0WIX8oU5QcwsUnUK9uNUFpO+KNuyYxpA"
            );
        </script>
    <script>
      // Workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=1404468
      const isFirefox = true;
    </script>
</head>

<body id="keycloak-bg" class="">
<div class="pf-v5-c-login">
  <div class="pf-v5-c-login__container">
    <header id="kc-header" class="pf-v5-c-login__header">
      <div id="kc-header-wrapper"
              class="pf-v5-c-brand">Oauth2</div>
    </header>
    <main class="pf-v5-c-login__main">
      <div class="pf-v5-c-login__main-header">
        <h1 class="pf-v5-c-title pf-m-3xl" id="kc-page-title"><!-- template: login.ftl -->

        Sign in to your account

</h1>
      </div>
      <div class="pf-v5-c-login__main-body">


<!-- template: login.ftl -->

        <div id="kc-form">
          <div id="kc-form-wrapper">
                <form id="kc-form-login" class="pf-v5-c-form" onsubmit="login.disabled = true; return true;" action="http://localhost:8080/realms/Oauth2/login-actions/authenticate?session_code=8JXNfAwRDGS2-yctFmVgwWh4vPsehZNKyYi-GucU1GE&amp;execution=048bd5f1-3361-4bc2-bf3f-d659c6d6851f&amp;client_id=oauth2-client-app&amp;tab_id=8f8WPLZBQYE&amp;client_data=eyJydSI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MSIsInJ0IjoiY29kZSJ9" method="post" novalidate="novalidate">

<div class="pf-v5-c-form__group">
    <div class="pf-v5-c-form__label">
        <label for="username" class="pf-v5-c-form__label">
        <span class="pf-v5-c-form__label-text">
                                        Username or email

        </span>
        </label>
    </div>

    <span class="pf-v5-c-form-control ">
        <input id="username" name="username" value="" type="text" autocomplete="username" autofocus
                aria-invalid=""/>
    </span>

    <div id="input-error-container-username">
    </div>
</div>


<div class="pf-v5-c-form__group">
    <div class="pf-v5-c-form__label">
        <label for="password" class="pf-v5-c-form__label">
        <span class="pf-v5-c-form__label-text">
            Password
        </span>
        </label>
    </div>

    <div class="pf-v5-c-input-group">
      <div class="pf-v5-c-input-group__item pf-m-fill">
        <span class="pf-v5-c-form-control ">
          <input id="password" name="password" value="" type="password" autocomplete="current-password" 
                  aria-invalid=""/>
        </span>
      </div>
      <div class="pf-v5-c-input-group__item">
        <button class="pf-v5-c-button pf-m-control" type="button" aria-label="Show password"
                aria-controls="password" data-password-toggle
                data-icon-show="fa-eye fas" data-icon-hide="fa-eye-slash fas"
                data-label-show="Show password" data-label-hide="Hide password">
            <i class="fa-eye fas" aria-hidden="true"></i>
        </button>
      </div>
    </div>

    <div id="input-error-container-password">
    </div>
</div>


                    <div class="pf-v5-c-form__group">
                    </div>

                    <input type="hidden" id="id-hidden-input" name="credentialId" />
  <div class="pf-v5-c-form__group">
    <div class="pf-v5-c-form__actions">
  <button class="pf-v5-c-button pf-m-primary pf-m-block " name="login" id="kc-login" type="submit">Sign In</button>
    </div>
  </div>
                </form>
            </div>
        </div>



      </div>
      <div class="pf-v5-c-login__main-footer">
<!-- template: login.ftl -->


      </div>
    </main>

  </div>
</div>
</body>
</html>
```

   - Client oauth2-client-appì˜ Settingsì—ì„œ Consent required On
   - http://localhost:8080/realms/Oauth2/protocol/openid-connect/auth?response_type=code&client_id=oauth2-client-app&scope=profile email&redirect_uri=http://localhost:8081 ë¡œ ë¸Œë¼ìš°ì €ë¡œ ì ‘ì†
     + ì‚¬ìš©ì ì •ë³´ (user) ì…ë ¥

3. í† í° ìš”ì²­
   - Realm Settingsì˜ EndPoints
```json
{
"issuer": "http://localhost:8080/realms/oauth2",
"authorization_endpoint": "http://localhost:8080/realms/oauth2/protocol/openid-connect/auth", // ì¸ê°€ 
"token_endpoint": "http://localhost:8080/realms/oauth2/protocol/openid-connect/token", // í† í° 
"introspection_endpoint": "http://localhost:8080/realms/oauth2/protocol/openid-connect/token/introspect",
"userinfo_endpoint": "http://localhost:8080/realms/oauth2/protocol/openid-connect/userinfo",
"end_session_endpoint": "http://localhost:8080/realms/oauth2/protocol/openid-connect/logout",
"frontchannel_logout_session_supported": true,
"frontchannel_logout_supported": true,
"jwks_uri": "http://localhost:8080/realms/oauth2/protocol/openid-connect/certs",
"check_session_iframe": "http://localhost:8080/realms/oauth2/protocol/openid-connect/login-status-iframe.html",
"grant_types_supported": [
"authorization_code",
"implicit",
"refresh_token",
"password",
"client_credentials",
"urn:ietf:params:oauth:grant-type:device_code",
"urn:openid:params:grant-type:ciba"
],

...

```

   - POST http://localhost:8080/realms/oauth2/protocol/openid-connect/token (Postman)
<div align="center">
<img src="https://github.com/user-attachments/assets/9fe6f031-7037-441a-bff6-d7de2a6e7484">
</div>

```json
{
    "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJRcjIxaWpsVUgzLXlaaEloZkF6NGN5TjdjZTJRcVEtdHVnOTQxTmZJLTBNIn0.eyJleHAiOjE3NDE4Njg3NDgsImlhdCI6MTc0MTg2ODQ0OCwiYXV0aF90aW1lIjoxNzQxODY4MDkyLCJqdGkiOiJjOTcxZTY1Mi0yMTM1LTQwNjUtYTIxMS04MWNjNDA5NDk2ZmQiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvcmVhbG1zL29hdXRoMiIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiJiNDc4MGI0NC1lYTUxLTQ3NWQtOWY0ZC0zNjc4ZjlkYzUwNDIiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJvYXV0aDItY2xpZW50LWFwcCIsInNlc3Npb25fc3RhdGUiOiI5MjA1NDUxMC01NjE4LTRjMTAtYWFjMS1hMzY4OTk3NjY1ODMiLCJhY3IiOiIwIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwidW1hX2F1dGhvcml6YXRpb24iLCJkZWZhdWx0LXJvbGVzLW9hdXRoMiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSBlbWFpbCIsInNpZCI6IjkyMDU0NTEwLTU2MTgtNGMxMC1hYWMxLWEzNjg5OTc2NjU4MyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwibmFtZSI6ImhhbiAgc3UgeWVvbmciLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJ1c2VyIiwiZ2l2ZW5fbmFtZSI6ImhhbiAiLCJmYW1pbHlfbmFtZSI6InN1IHllb25nIiwiZW1haWwiOiJ1c2VyQGtleWNsb2FrLmNvbSJ9.OHBG_wrg3nHId7SbvgC9tzF1WHxAak1o_0FLoFsk3zIbgvvaKolkdlM_HOGucokfqB7mWfWRITAtT2qf_cfp-85lpBNECtW_inGJ5_s4RGLSqOXcQ6UhC2SBXJrrqTWae9E0ym5IdqXBAM3Tl67GIPD3DdjAFj57LZuKELsvsBKdC5iV8Q1Cajld1x0DeY7G_JTedMc3iK5jFhLhlvzOhUsveaw5_L0irj_94wX81AbdpZNCiM0m1gbJ4PcgIPqcRBLR5YiAy3SzJLIFAF6A6pal-Wlht48nU1NeGB2Mqo0Hw0xaJGxgskiFqUNEXFxBu0e9O54hIEQoLiNL8qO-uA",
    "expires_in": 298,
    "refresh_expires_in": 1800,
    "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJjZWRmNDE4ZS1hNzZlLTQ5N2QtOTZiNC1mNGI1NTM1ZWRkYzUifQ.eyJleHAiOjE3NDE4NzAyNTAsImlhdCI6MTc0MTg2ODQ1MCwianRpIjoiNzhhM2I2MmYtNWRlNi00YTAxLWEyZjctOGFlZjRhZTBmODYxIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL3JlYWxtcy9vYXV0aDIiLCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvcmVhbG1zL29hdXRoMiIsInN1YiI6ImI0NzgwYjQ0LWVhNTEtNDc1ZC05ZjRkLTM2NzhmOWRjNTA0MiIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJvYXV0aDItY2xpZW50LWFwcCIsInNlc3Npb25fc3RhdGUiOiI5MjA1NDUxMC01NjE4LTRjMTAtYWFjMS1hMzY4OTk3NjY1ODMiLCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJzaWQiOiI5MjA1NDUxMC01NjE4LTRjMTAtYWFjMS1hMzY4OTk3NjY1ODMifQ.cLLK6ZJMtY3eZNEy-nJ7t9laNoal3G76L6OE3OqE540",
    "token_type": "Bearer",
    "not-before-policy": 0,
    "session_state": "92054510-5618-4c10-aac1-a36899766583",
    "scope": "profile email"
}
```

4. ì•¡ì„¸ìŠ¤ í† í°ì„ í†µí•´ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
   - Authorizationì˜ Type : Bearer Tokenì— Access Token ì…ë ¥
   - GET http://localhost:8080/realms/oauth2/protocol/openid-connect/userinfo

<div align="center">
<img src="https://github.com/user-attachments/assets/2d5da856-9b56-409b-9a59-2455afba81ba">
</div>

5. ì •ë¦¬
   - Client : Postman
   - Autrhoziation Server : Keycloak
   - ì‚¬ìš©ì
   - ì‚¬ìš©ìì—ê²Œ ì•¡ì„¸ìŠ¤ í† í°ì„ í†µí•´ ì •ë³´ ì œê³µ : Resource Server

   - ì •ë³´ë¥¼ Resource Serverê°€ ì œê³µí•œ ê²ƒ
